---
title: "Devils_is_in_details"
author: "Dario Saturni"
date: "01/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## What's more interesting than a bunch of random curiosity about gas price or Ethereum in general?

Exploring the dataset about Ethereum in bigquery we can find some interesting facts about the cryptocurrency behaviour during last year.

Open bigquery and try to execute this:

```{mysql eval=FALSE}
SELECT
EXTRACT(MONTH FROM block_timestamp) as max_price_month,
EXTRACT(HOUR FROM block_timestamp) as max_price_hour
FROM `bigquery-public-data.crypto_ethereum.transactions`
WHERE gas_price = (
  SELECT
  MAX(gas_price) AS max_price,
  FROM `bigquery-public-data.crypto_ethereum.transactions`
  WHERE EXTRACT(YEAR FROM block_timestamp) = 2020
)
```

It's a query that gives us the max value that was transferred and in which hour it was done. Given the facts we already investigate in Ethereum_gas_price_2020 (you can find it in this repository)
one would expect to find this kind of value to be in July or August and between 22-24 PM (UTC), instead we discover that the transaction was registered during 3 AM (UTC) in June. 
June is near the bottom per transactions registered as you can see if you execute the code below:

```{mysql eval=FALSE}
SELECT
COUNT(EXTRACT(MONTH FROM block_timestamp)) as june_number_transaction,
FROM `bigquery-public-data.crypto_ethereum.transactions`
WHERE receipt_status = 1 AND EXTRACT(MONTH FROM block_timestamp) = 6
```

It gives you the exact number of validated transactions during June. Reminder, from a sheer point of view from what we've already seen in Ethereum_gas_price_2020 June had over 85 million of transaction but only a fraction of them were executed with a valid receipt.

Let's ask a question to ourselves: how much the max gas price influenced the value of the highest transaction? Is there a link between the gas price and the value of the transactions? Is it strong? How much influence does gas price has over the value of the transaction on average?

```{mysql eval=FALSE}
SELECT
MAX(gas_price) AS max_gas_price,
MAX(value) AS max_value,
CAST(MAX(gas_price)/MAX(value)*100) AS FLOAT64) AS max_gas_price_on_value,
CAST(AVG(gas_price) AS FLOAT64) AS avg_gas_price,
CAST(AVG(value) AS FLOAT64) AS avg_value,
CAST(AVG(gas_price)/AVG(value)*100 AS FLOAT64) AS avg_gas_price_on_value,
CAST(STDDEV(gas_price) AS FLOAT64) AS stdev_gas_price,
CAST(STDDEV(value) AS FLOAT64) AS stdev_value,
CAST(CORR(gas_price, value) AS FLOAT64) AS cv_gas_price_over_value,
FROM `bigquery-public-data.crypto_ethereum.transactions`
WHERE receipt_status = 1 AND EXTRACT(YEAR FROM block_timestamp) = 2020
```
This query pretty much tells us a story. There's a weak link between gas price and value of the transaction. Working with Wei make it difficult to visualize it because we talk about big numbers on screen.
Also gas price on average is responsible for a tiny fraction of the value of the exchange. Let's try to calculate the link (if there's any) between the number of transactions and the gas's price.

